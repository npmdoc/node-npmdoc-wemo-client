<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://github.com/timonreinhard/wemo-client"

    >wemo-client (v0.11.2)</a>
</h1>
<h4>Client library for interacting with Belkin Wemo devices</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.wemo-client">module wemo-client</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.wemo-client.wemo-client">
            function <span class="apidocSignatureSpan"></span>wemo-client
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.wemo-client.client">
            function <span class="apidocSignatureSpan">wemo-client.</span>client
            <span class="apidocSignatureSpan">(config)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">wemo-client.</span>DEVICE_TYPE</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">wemo-client.</span>client.prototype</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.wemo-client.client">module wemo-client.client</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.wemo-client.client.client">
            function <span class="apidocSignatureSpan">wemo-client.</span>client
            <span class="apidocSignatureSpan">(config)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.wemo-client.client.request">
            function <span class="apidocSignatureSpan">wemo-client.client.</span>request
            <span class="apidocSignatureSpan">(options, data, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.wemo-client.client.rgb2xy">
            function <span class="apidocSignatureSpan">wemo-client.client.</span>rgb2xy
            <span class="apidocSignatureSpan">(r, g, b)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.wemo-client.client.super_">
            function <span class="apidocSignatureSpan">wemo-client.client.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">wemo-client.client.</span>EventServices</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.wemo-client.client.prototype">module wemo-client.client.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.wemo-client.client.prototype._onListenerAdded">
            function <span class="apidocSignatureSpan">wemo-client.client.prototype.</span>_onListenerAdded
            <span class="apidocSignatureSpan">(eventName)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.wemo-client.client.prototype._parseInsightParams">
            function <span class="apidocSignatureSpan">wemo-client.client.prototype.</span>_parseInsightParams
            <span class="apidocSignatureSpan">(paramsStr)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.wemo-client.client.prototype._subscribe">
            function <span class="apidocSignatureSpan">wemo-client.client.prototype.</span>_subscribe
            <span class="apidocSignatureSpan">(serviceType)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.wemo-client.client.prototype.getAttributes">
            function <span class="apidocSignatureSpan">wemo-client.client.prototype.</span>getAttributes
            <span class="apidocSignatureSpan">(cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.wemo-client.client.prototype.getBinaryState">
            function <span class="apidocSignatureSpan">wemo-client.client.prototype.</span>getBinaryState
            <span class="apidocSignatureSpan">(cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.wemo-client.client.prototype.getDeviceStatus">
            function <span class="apidocSignatureSpan">wemo-client.client.prototype.</span>getDeviceStatus
            <span class="apidocSignatureSpan">(deviceId, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.wemo-client.client.prototype.getEndDevices">
            function <span class="apidocSignatureSpan">wemo-client.client.prototype.</span>getEndDevices
            <span class="apidocSignatureSpan">(cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.wemo-client.client.prototype.getInsightParams">
            function <span class="apidocSignatureSpan">wemo-client.client.prototype.</span>getInsightParams
            <span class="apidocSignatureSpan">(cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.wemo-client.client.prototype.handleCallback">
            function <span class="apidocSignatureSpan">wemo-client.client.prototype.</span>handleCallback
            <span class="apidocSignatureSpan">(body)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.wemo-client.client.prototype.setBinaryState">
            function <span class="apidocSignatureSpan">wemo-client.client.prototype.</span>setBinaryState
            <span class="apidocSignatureSpan">(value, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.wemo-client.client.prototype.setDeviceStatus">
            function <span class="apidocSignatureSpan">wemo-client.client.prototype.</span>setDeviceStatus
            <span class="apidocSignatureSpan">(deviceId, capability, value, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.wemo-client.client.prototype.setLightColor">
            function <span class="apidocSignatureSpan">wemo-client.client.prototype.</span>setLightColor
            <span class="apidocSignatureSpan">(deviceId, red, green, blue, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.wemo-client.client.prototype.soapAction">
            function <span class="apidocSignatureSpan">wemo-client.client.prototype.</span>soapAction
            <span class="apidocSignatureSpan">(serviceType, action, body, cb)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.wemo-client" id="apidoc.module.wemo-client">module wemo-client</a></h1>


    <h2>
        <a href="#apidoc.element.wemo-client.wemo-client" id="apidoc.element.wemo-client.wemo-client">
        function <span class="apidocSignatureSpan"></span>wemo-client
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">wemo-client = function (opts) {
  opts = opts || {};
  this._port = opts.port || 0;

  this._clients = {};
  this._listen();
  this._ssdpClient = new SSDPClient(opts.discover_opts || {});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.wemo-client.client" id="apidoc.element.wemo-client.client">
        function <span class="apidocSignatureSpan">wemo-client.</span>client
        <span class="apidocSignatureSpan">(config)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">client = function (config) {
  EventEmitter.call(this);
  this.host = config.host;
  this.port = config.port;
  this.deviceType = config.deviceType;
  this.UDN = config.UDN;
  this.subscriptions = {};
  this.callbackURL = config.callbackURL;
  this.device = config;
  this.error = undefined;

  // Create map of services
  config.serviceList.service.forEach(function(service) {
    this[service.serviceType] = {
      serviceId: service.serviceId,
      controlURL: service.controlURL,
      eventSubURL: service.eventSubURL
    };
  }, this.services = {});

  // Transparently subscribe to serviceType events
  // TODO: Unsubscribe from ServiceType when all listeners have been removed.
  this.on(&#x27;newListener&#x27;, this._onListenerAdded);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var Wemo = require(&#x27;wemo-client&#x27;);
var wemo = new Wemo();

wemo.discover(function(deviceInfo) {
console.log(&#x27;Wemo Device Found: %j&#x27;, deviceInfo);

// Get the client for the found device
var client = wemo.<span class="apidocCodeKeywordSpan">client</span>(deviceInfo);

// Handle BinaryState events
client.on(&#x27;binaryState&#x27;, function(value) {
  console.log(&#x27;Binary State changed to: %s&#x27;, value);
});

// Turn the switch on
...</pre></li>
    </ul>






</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.wemo-client.client" id="apidoc.module.wemo-client.client">module wemo-client.client</a></h1>


    <h2>
        <a href="#apidoc.element.wemo-client.client.client" id="apidoc.element.wemo-client.client.client">
        function <span class="apidocSignatureSpan">wemo-client.</span>client
        <span class="apidocSignatureSpan">(config)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">client = function (config) {
  EventEmitter.call(this);
  this.host = config.host;
  this.port = config.port;
  this.deviceType = config.deviceType;
  this.UDN = config.UDN;
  this.subscriptions = {};
  this.callbackURL = config.callbackURL;
  this.device = config;
  this.error = undefined;

  // Create map of services
  config.serviceList.service.forEach(function(service) {
    this[service.serviceType] = {
      serviceId: service.serviceId,
      controlURL: service.controlURL,
      eventSubURL: service.eventSubURL
    };
  }, this.services = {});

  // Transparently subscribe to serviceType events
  // TODO: Unsubscribe from ServiceType when all listeners have been removed.
  this.on(&#x27;newListener&#x27;, this._onListenerAdded);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var Wemo = require(&#x27;wemo-client&#x27;);
var wemo = new Wemo();

wemo.discover(function(deviceInfo) {
console.log(&#x27;Wemo Device Found: %j&#x27;, deviceInfo);

// Get the client for the found device
var client = wemo.<span class="apidocCodeKeywordSpan">client</span>(deviceInfo);

// Handle BinaryState events
client.on(&#x27;binaryState&#x27;, function(value) {
  console.log(&#x27;Binary State changed to: %s&#x27;, value);
});

// Turn the switch on
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.wemo-client.client.request" id="apidoc.element.wemo-client.client.request">
        function <span class="apidocSignatureSpan">wemo-client.client.</span>request
        <span class="apidocSignatureSpan">(options, data, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">request = function (options, data, cb) {
  if (!cb &#x26;&#x26; typeof data === &#x27;function&#x27;) {
    cb = data;
    data = null;
  }

  var req = http.request(options, function(res) {
    var body = &#x27;&#x27;;
    res.setEncoding(&#x27;utf8&#x27;);
    res.on(&#x27;data&#x27;, function(chunk) {
      body += chunk;
    });
    res.on(&#x27;end&#x27;, function() {
      if (res.statusCode === 200) {
        xml2js.parseString(body, { explicitArray: false }, cb);
      } else {
        cb(new Error(&#x27;HTTP &#x27; + res.statusCode + &#x27;: &#x27; + body));
      }
    });
    res.on(&#x27;error&#x27;, function(err) {
      debug(&#x27;Error on http.request.res:&#x27;, err);
      cb(err);
    });
  });
  req.on(&#x27;error&#x27;, function(err) {
    debug(&#x27;Error on http.request.req:&#x27;, err);
    cb(err);
  });
  if (data) {
    req.write(data);
  }
  req.end();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
LightSwitch: &#x27;urn:Belkin:device:lightswitch:1&#x27;
};

Wemo.prototype.load = function(setupUrl, cb) {
var self = this;
var location = url.parse(setupUrl);

WemoClient.<span class="apidocCodeKeywordSpan">request</span>({
  host: location.hostname,
  port: location.port,
  path: location.path,
  method: &#x27;GET&#x27;
}, function(err, json) {
  if (!err &#x26;&#x26; json) {
    var device = json.root.device;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.wemo-client.client.rgb2xy" id="apidoc.element.wemo-client.client.rgb2xy">
        function <span class="apidocSignatureSpan">wemo-client.client.</span>rgb2xy
        <span class="apidocSignatureSpan">(r, g, b)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">rgb2xy = function (r, g, b) {
  // Based on: https://github.com/aleroddepaz/pyhue/blob/master/src/pyhue.py
  var X = (0.545053 * r) + (0.357580 * g) + (0.180423 * b);
  var Y = (0.212671 * r) + (0.715160 * g) + (0.072169 * b);
  var Z = (0.019334 * r) + (0.119193 * g) + (0.950227 * b);

  var x = X / (X + Y + Z);
  var y = Y / (X + Y + Z);

  return [
    Math.round(x * 65535),
    Math.round(y * 65535)
  ];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

this.soapAction(&#x27;urn:Belkin:service:bridge:1&#x27;, &#x27;GetDeviceStatus&#x27;, {
  DeviceIDs: deviceId
}, parseResponse);
};

WemoClient.prototype.setLightColor = function(deviceId, red, green, blue, cb) {
var color = WemoClient.<span class="apidocCodeKeywordSpan">rgb2xy</span>(red, green, blue);
this.setDeviceStatus(deviceId, 10300, color.join(&#x27;:&#x27;) + &#x27;:0&#x27;, cb);
};

WemoClient.prototype.setBinaryState = function(value, cb) {
this.soapAction(&#x27;urn:Belkin:service:basicevent:1&#x27;, &#x27;SetBinaryState&#x27;, {
  BinaryState: value
}, cb);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.wemo-client.client.super_" id="apidoc.element.wemo-client.client.super_">
        function <span class="apidocSignatureSpan">wemo-client.client.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.wemo-client.client.prototype" id="apidoc.module.wemo-client.client.prototype">module wemo-client.client.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.wemo-client.client.prototype._onListenerAdded" id="apidoc.element.wemo-client.client.prototype._onListenerAdded">
        function <span class="apidocSignatureSpan">wemo-client.client.prototype.</span>_onListenerAdded
        <span class="apidocSignatureSpan">(eventName)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_onListenerAdded = function (eventName) {
  var serviceType = WemoClient.EventServices[eventName];
  if (serviceType &#x26;&#x26; this.services[serviceType]) {
    this._subscribe(serviceType);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.wemo-client.client.prototype._parseInsightParams" id="apidoc.element.wemo-client.client.prototype._parseInsightParams">
        function <span class="apidocSignatureSpan">wemo-client.client.prototype.</span>_parseInsightParams
        <span class="apidocSignatureSpan">(paramsStr)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_parseInsightParams = function (paramsStr) {
  var params = paramsStr.split(&#x27;|&#x27;);

  return {
    binaryState: params[0],
    instantPower: params[7],
    insightParams: {
      ONSince: params[1],
      OnFor: params[2],
      TodayONTime: params[3],
      TodayConsumed: params[8]  // power consumer today (mW per minute)
    }
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
});
};

WemoClient.prototype.getInsightParams = function(cb) {
this.soapAction(&#x27;urn:Belkin:service:insight:1&#x27;, &#x27;GetInsightParams&#x27;, null, function(err, data) {
  if (err) return cb(err);

  var params = this.<span class="apidocCodeKeywordSpan">_parseInsightParams</span>(data.InsightParams);
  cb(null, params.binaryState, params.instantPower, params.insightParams);
}.bind(this));
};

WemoClient.prototype._parseInsightParams = function(paramsStr) {
var params = paramsStr.split(&#x27;|&#x27;);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.wemo-client.client.prototype._subscribe" id="apidoc.element.wemo-client.client.prototype._subscribe">
        function <span class="apidocSignatureSpan">wemo-client.client.prototype.</span>_subscribe
        <span class="apidocSignatureSpan">(serviceType)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_subscribe = function (serviceType) {
  if (!this.services[serviceType]) {
    throw new Error(&#x27;Service &#x27; + serviceType + &#x27; not supported by &#x27; + this.UDN);
  }
  if (!this.callbackURL) {
    throw new Error(&#x27;Can not subscribe without callbackURL&#x27;);
  }
  if (this.subscriptions[serviceType] &#x26;&#x26; this.subscriptions[serviceType] === &#x27;PENDING&#x27;) {
    debug(&#x27;subscription still pending&#x27;);
    return;
  }

  var options = {
    host: this.host,
    port: this.port,
    path: this.services[serviceType].eventSubURL,
    method: &#x27;SUBSCRIBE&#x27;,
    headers: {
      TIMEOUT: &#x27;Second-300&#x27;
    }
  };

  if (!this.subscriptions[serviceType]) {
    // Initial subscription
    this.subscriptions[serviceType] = &#x27;PENDING&#x27;;
    debug(&#x27;Initial subscription - Device: %s, Service: %s&#x27;, this.UDN, serviceType);
    options.headers.CALLBACK = &#x27;&#x3c;&#x27; + this.callbackURL + &#x27;/&#x27; + this.UDN + &#x27;&#x3e;&#x27;;
    options.headers.NT = &#x27;upnp:event&#x27;;
  } else {
    // Subscription renewal
    debug(&#x27;Renewing subscription - Device: %s, Service: %s&#x27;, this.UDN, serviceType);
    options.headers.SID = this.subscriptions[serviceType];
  }

  var req = http.request(options, function(res) {
    if (res.statusCode === 200) {
      // Renew after 150 seconds
      this.subscriptions[serviceType] = res.headers.sid;
      setTimeout(this._subscribe.bind(this), 150 * 1000, serviceType);
    } else {
      // Try to recover from failed subscription after 2 seconds
      debug(&#x27;Subscription request failed with HTTP %s&#x27;, res.statusCode);
      this.subscriptions[serviceType] = null;
      setTimeout(this._subscribe.bind(this), 2000, serviceType);
    }
  }.bind(this));

  req.on(&#x27;error&#x27;, function(err) {
    debug(&#x27;Subscription error: %s - Device: %s, Service: %s&#x27;, err.code, this.UDN, serviceType);
    this.subscriptions[serviceType] = null;
    this.error = err.code;
    this.emit(&#x27;error&#x27;, err);
  }.bind(this));

  req.end();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  }
};
};

WemoClient.prototype._onListenerAdded = function(eventName) {
var serviceType = WemoClient.EventServices[eventName];
if (serviceType &#x26;&#x26; this.services[serviceType]) {
  this.<span class="apidocCodeKeywordSpan">_subscribe</span>(serviceType);
}
};

WemoClient.prototype._subscribe = function(serviceType) {
if (!this.services[serviceType]) {
  throw new Error(&#x27;Service &#x27; + serviceType + &#x27; not supported by &#x27; + this.UDN);
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.wemo-client.client.prototype.getAttributes" id="apidoc.element.wemo-client.client.prototype.getAttributes">
        function <span class="apidocSignatureSpan">wemo-client.client.prototype.</span>getAttributes
        <span class="apidocSignatureSpan">(cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getAttributes = function (cb) {
  this.soapAction(&#x27;urn:Belkin:service:deviceevent:1&#x27;, &#x27;GetAttributes&#x27;, null, function(err, data) {
    if (err) return cb(err);
    var xml = &#x27;&#x3c;attributeList&#x3e;&#x27; + entities.decodeXML(data.attributeList) + &#x27;&#x3c;/attributeList&#x3e;&#x27;;
    xml2js.parseString(xml, { explicitArray: false }, function(err, result) {
      if (err) return cb(err);
      var attributes = {};
      for (var key in result.attributeList.attribute) {
        var attribute = result.attributeList.attribute[key];
        attributes[attribute.name] = attribute.value;
      }
      cb(null, attributes);
    });
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.wemo-client.client.prototype.getBinaryState" id="apidoc.element.wemo-client.client.prototype.getBinaryState">
        function <span class="apidocSignatureSpan">wemo-client.client.prototype.</span>getBinaryState
        <span class="apidocSignatureSpan">(cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getBinaryState = function (cb) {
  this.soapAction(&#x27;urn:Belkin:service:basicevent:1&#x27;, &#x27;GetBinaryState&#x27;, null, function(err, data) {
    if (err) return cb(err);
    cb(null, data.BinaryState);
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.wemo-client.client.prototype.getDeviceStatus" id="apidoc.element.wemo-client.client.prototype.getDeviceStatus">
        function <span class="apidocSignatureSpan">wemo-client.client.prototype.</span>getDeviceStatus
        <span class="apidocSignatureSpan">(deviceId, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getDeviceStatus = function (deviceId, cb) {
  var parseResponse = function(err, data) {
    if (err) return cb(err);
    xml2js.parseString(data.DeviceStatusList, { explicitArray: false }, function(err, result) {
      if (err) return cb(err);
      var deviceStatus = result[&#x27;DeviceStatusList&#x27;][&#x27;DeviceStatus&#x27;];
      var capabilities = mapCapabilities(deviceStatus.CapabilityID, deviceStatus.CapabilityValue);
      cb(null, capabilities);
    });
  };

  this.soapAction(&#x27;urn:Belkin:service:bridge:1&#x27;, &#x27;GetDeviceStatus&#x27;, {
    DeviceIDs: deviceId
  }, parseResponse);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.wemo-client.client.prototype.getEndDevices" id="apidoc.element.wemo-client.client.prototype.getEndDevices">
        function <span class="apidocSignatureSpan">wemo-client.client.prototype.</span>getEndDevices
        <span class="apidocSignatureSpan">(cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getEndDevices = function (cb) {
  var parseDeviceInfo = function(data) {
    var device = {};

    if (data.GroupID) {
      // treat device group as it was a single device
      device.friendlyName = data.GroupName[0];
      device.deviceId = data.GroupID[0];
      device.capabilities = mapCapabilities(
        data.GroupCapabilityIDs[0],
        data.GroupCapabilityValues[0]
      );
    } else {
      // single device
      device.friendlyName = data.FriendlyName[0];
      device.deviceId = data.DeviceID[0];
      device.capabilities = mapCapabilities(
        data.CapabilityIDs[0],
        data.CurrentState[0]
      );
    }

    // set device type
    if (device.capabilities.hasOwnProperty(&#x27;10008&#x27;)) {
      device.deviceType = &#x27;dimmableLight&#x27;;
    }
    if (device.capabilities.hasOwnProperty(&#x27;10300&#x27;)) {
      device.deviceType = &#x27;colorLight&#x27;;
    }

    return device;
  };

  var parseResponse = function(err, data) {
    if (err) return cb(err);
    debug(&#x27;endDevices raw data&#x27;, data);
    var endDevices = [];
    xml2js.parseString(data.DeviceLists, function(err, result) {
      if (err) return cb(err);
      var deviceInfos = result.DeviceLists.DeviceList[0].DeviceInfos[0].DeviceInfo;
      if (deviceInfos) {
        Array.prototype.push.apply(endDevices, deviceInfos.map(parseDeviceInfo));
      }
      if (result.DeviceLists.DeviceList[0].GroupInfos) {
        var groupInfos = result.DeviceLists.DeviceList[0].GroupInfos[0].GroupInfo;
        Array.prototype.push.apply(endDevices, groupInfos.map(parseDeviceInfo));
      }
      cb(null, endDevices);
    });
  };

  this.soapAction(&#x27;urn:Belkin:service:bridge:1&#x27;, &#x27;GetEndDevices&#x27;, {
    DevUDN: this.UDN,
    ReqListType: &#x27;PAIRED_LIST&#x27;
  }, parseResponse);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.wemo-client.client.prototype.getInsightParams" id="apidoc.element.wemo-client.client.prototype.getInsightParams">
        function <span class="apidocSignatureSpan">wemo-client.client.prototype.</span>getInsightParams
        <span class="apidocSignatureSpan">(cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getInsightParams = function (cb) {
  this.soapAction(&#x27;urn:Belkin:service:insight:1&#x27;, &#x27;GetInsightParams&#x27;, null, function(err, data) {
    if (err) return cb(err);

    var params = this._parseInsightParams(data.InsightParams);
    cb(null, params.binaryState, params.instantPower, params.insightParams);
  }.bind(this));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.wemo-client.client.prototype.handleCallback" id="apidoc.element.wemo-client.client.prototype.handleCallback">
        function <span class="apidocSignatureSpan">wemo-client.client.prototype.</span>handleCallback
        <span class="apidocSignatureSpan">(body)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">handleCallback = function (body) {
  var self = this;
  var handler = {
    BinaryState: function(data) {
      self.emit(&#x27;binaryState&#x27;, data.substring(0, 1));
    },
    StatusChange: function(data) {
      xml2js.parseString(data, { explicitArray: false }, function(err, xml) {
        if (!err) {
          self.emit(&#x27;statusChange&#x27;,
            xml.StateEvent.DeviceID._,
            xml.StateEvent.CapabilityId,
            xml.StateEvent.Value
          );
        }
      });
    },
    InsightParams: function(data) {
      var params = this._parseInsightParams(data);
      self.emit(&#x27;insightParams&#x27;, params.binaryState, params.instantPower, params.insightParams);
    }.bind(this),
    attributeList: function(data) {
      var xml = &#x27;&#x3c;attributeList&#x3e;&#x27; + entities.decodeXML(data) + &#x27;&#x3c;/attributeList&#x3e;&#x27;;
      xml2js.parseString(xml, { explicitArray: true }, function(err, result) {
        if (!err) {
          // In order to keep the existing event signature this
          // triggers an event for every attribute changed.
          result.attributeList.attribute.forEach(function(attribute) {
            self.emit(&#x27;attributeList&#x27;,
              attribute.name[0],
              attribute.value[0],
              attribute.prevalue[0],
              attribute.ts[0]
            );
          });
        }
      });
    }
  };

  xml2js.parseString(body, { explicitArray: false }, function(err, xml) {
    if (err) throw err;
    for (var prop in xml[&#x27;e:propertyset&#x27;][&#x27;e:property&#x27;]) {
      if (handler.hasOwnProperty(prop)) {
        handler[prop](xml[&#x27;e:propertyset&#x27;][&#x27;e:property&#x27;][prop]);
      } else {
        debug(&#x27;Unhandled Event: %s&#x27;, prop);
      }
    }
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

if ((req.method == &#x27;NOTIFY&#x27;) &#x26;&#x26; this._clients[udn]) {
  req.on(&#x27;data&#x27;, function(chunk) {
    body += chunk.toString();
  });
  req.on(&#x27;end&#x27;, function() {
    debug(&#x27;Incoming Request for %s: %s&#x27;, udn, body);
    this._clients[udn].<span class="apidocCodeKeywordSpan">handleCallback</span>(body);
    res.writeHead(204);
    res.end();
  }.bind(this));
} else {
  debug(&#x27;Received request for unknown device: %s&#x27;, udn);
  res.writeHead(404);
  res.end();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.wemo-client.client.prototype.setBinaryState" id="apidoc.element.wemo-client.client.prototype.setBinaryState">
        function <span class="apidocSignatureSpan">wemo-client.client.prototype.</span>setBinaryState
        <span class="apidocSignatureSpan">(value, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setBinaryState = function (value, cb) {
  this.soapAction(&#x27;urn:Belkin:service:basicevent:1&#x27;, &#x27;SetBinaryState&#x27;, {
    BinaryState: value
  }, cb);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

  // Handle BinaryState events
  client.on(&#x27;binaryState&#x27;, function(value) {
    console.log(&#x27;Binary State changed to: %s&#x27;, value);
  });

  // Turn the switch on
  client.<span class="apidocCodeKeywordSpan">setBinaryState</span>(1);
});
```

## API

### Wemo
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.wemo-client.client.prototype.setDeviceStatus" id="apidoc.element.wemo-client.client.prototype.setDeviceStatus">
        function <span class="apidocSignatureSpan">wemo-client.client.prototype.</span>setDeviceStatus
        <span class="apidocSignatureSpan">(deviceId, capability, value, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setDeviceStatus = function (deviceId, capability, value, cb) {
  var deviceStatusList = xmlbuilder.create(&#x27;DeviceStatus&#x27;, {
    version: &#x27;1.0&#x27;,
    encoding: &#x27;utf-8&#x27;
  }).ele({
    IsGroupAction: (deviceId.length === 10) ? &#x27;YES&#x27; : &#x27;NO&#x27;,
    DeviceID: deviceId,
    CapabilityID: capability,
    CapabilityValue: value
  }).end();

  this.soapAction(&#x27;urn:Belkin:service:bridge:1&#x27;, &#x27;SetDeviceStatus&#x27;, {
    DeviceStatusList: {
      &#x27;#text&#x27;: deviceStatusList
    }
  }, cb);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  this.soapAction(&#x27;urn:Belkin:service:bridge:1&#x27;, &#x27;GetDeviceStatus&#x27;, {
    DeviceIDs: deviceId
  }, parseResponse);
};

WemoClient.prototype.setLightColor = function(deviceId, red, green, blue, cb) {
  var color = WemoClient.rgb2xy(red, green, blue);
  this.<span class="apidocCodeKeywordSpan">setDeviceStatus</span>(deviceId, 10300, color.join(&#x27;:&#x27;) + &#x27;:0&#x27;, cb
);
};

WemoClient.prototype.setBinaryState = function(value, cb) {
  this.soapAction(&#x27;urn:Belkin:service:basicevent:1&#x27;, &#x27;SetBinaryState&#x27;, {
    BinaryState: value
  }, cb);
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.wemo-client.client.prototype.setLightColor" id="apidoc.element.wemo-client.client.prototype.setLightColor">
        function <span class="apidocSignatureSpan">wemo-client.client.prototype.</span>setLightColor
        <span class="apidocSignatureSpan">(deviceId, red, green, blue, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setLightColor = function (deviceId, red, green, blue, cb) {
  var color = WemoClient.rgb2xy(red, green, blue);
  this.setDeviceStatus(deviceId, 10300, color.join(&#x27;:&#x27;) + &#x27;:0&#x27;, cb);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.wemo-client.client.prototype.soapAction" id="apidoc.element.wemo-client.client.prototype.soapAction">
        function <span class="apidocSignatureSpan">wemo-client.client.prototype.</span>soapAction
        <span class="apidocSignatureSpan">(serviceType, action, body, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">soapAction = function (serviceType, action, body, cb) {
  cb = cb || function() {};

  var xml = xmlbuilder.create(&#x27;s:Envelope&#x27;, {
    version: &#x27;1.0&#x27;,
    encoding: &#x27;utf-8&#x27;,
    allowEmpty: true
  })
  .att(&#x27;xmlns:s&#x27;, &#x27;http://schemas.xmlsoap.org/soap/envelope/&#x27;)
  .att(&#x27;s:encodingStyle&#x27;, &#x27;http://schemas.xmlsoap.org/soap/encoding/&#x27;)
  .ele(&#x27;s:Body&#x27;)
  .ele(&#x27;u:&#x27; + action)
  .att(&#x27;xmlns:u&#x27;, serviceType);

  var payload = (body ? xml.ele(body) : xml).end();

  var options = {
    host: this.host,
    port: this.port,
    path: this.services[serviceType].controlURL,
    method: &#x27;POST&#x27;,
    headers: {
      &#x27;SOAPACTION&#x27;: &#x27;&#x22;&#x27; + serviceType + &#x27;#&#x27; + action + &#x27;&#x22;&#x27;,
      &#x27;Content-Type&#x27;: &#x27;text/xml; charset=&#x22;utf-8&#x22;&#x27;
    }
  };

  WemoClient.request(options, payload, function(err, response) {
    if (err) {
      this.error = err.code;
      this.emit(&#x27;error&#x27;, err);
      return cb(err);
    }
    debug(&#x27;%s Response: &#x27;, action, response);
    cb(null, response &#x26;&#x26; response[&#x27;s:Envelope&#x27;][&#x27;s:Body&#x27;][&#x27;u:&#x27; + action + &#x27;Response&#x27;]);
  }.bind(this));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      var groupInfos = result.DeviceLists.DeviceList[0].GroupInfos[0].GroupInfo;
      Array.prototype.push.apply(endDevices, groupInfos.map(parseDeviceInfo));
    }
    cb(null, endDevices);
  });
};

this.<span class="apidocCodeKeywordSpan">soapAction</span>(&#x27;urn:Belkin:service:bridge:1&#x27;, &#x27;GetEndDevices&#x27;, {
  DevUDN: this.UDN,
  ReqListType: &#x27;PAIRED_LIST&#x27;
}, parseResponse);
};

WemoClient.prototype.setDeviceStatus = function(deviceId, capability, value, cb) {
var deviceStatusList = xmlbuilder.create(&#x27;DeviceStatus&#x27;, {
...</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
